---
date: 2025-10-14T10:06:38+08:00
researcher: Liam
git_commit: 13abec1fbd9e321f6005edbcfb31ee0ef253c173
branch: main
repository: nextjs-learning-page-router
topic: "Investigate missing image in redx-devtools markdown page"
tags: [research, codebase, markdown, assets]
status: complete
last_updated: 2025-10-14
last_updated_by: Liam
---

# Research: Investigate missing image in redx-devtools markdown page

**Date**: 2025-10-14T10:06:38+08:00  
**Researcher**: Liam  
**Git Commit**: 13abec1fbd9e321f6005edbcfb31ee0ef253c173  
**Branch**: main  
**Repository**: nextjs-learning-page-router

## Research Question

The `src/page-content/redx-devtools.md` article embeds an image, but the generated web page omits it. What existing code and content paths explain the missing image?

## Summary

The Markdown file stores the image reference as `/public/redux_devtools_screenshot.png` (`src/page-content/redx-devtools.md:60`). During build time the `loadMarkdown` pipeline preserves that path verbatim in the rendered HTML (`src/lib/content/markdown.ts:34-90`). When Next.js serves the static page, the browser requests `/public/redux_devtools_screenshot.png`, but static assets in Next.js are mounted at the site root, so the server looks for `public/public/redux_devtools_screenshot.png`, which does not exist while the actual file resides at `public/redux_devtools_screenshot.png`. Because no middleware or renderer rewrites the URL, the request returns 404 and the image never appears.

## Detailed Findings

### Markdown source embeds `/public/...`

- `src/page-content/redx-devtools.md:1-97` defines the article content, and line 60 uses the image syntax `![Redux DevTools Screenshot](/public/redux_devtools_screenshot.png)`. That leading `/public/` segment is retained during rendering and dictates the browser request path.

### Content pipeline preserves absolute paths

- `src/lib/content/markdown.ts:34-90` constructs the remark/rehype processor with `rehype-raw`, `rehype-sanitize`, `rehype-slug`, and `rehype-stringify`, ultimately turning Markdown into HTML. The sanitizer's default schema allows the `<img>` element and its `src` attribute, so the generated HTML keeps the original `/public/...` URL without transformation or validation.

### Markdown pages render HTML as-is

- `src/pages/[slug].tsx:25-88` statically loads Markdown documents via `loadMarkdown` and passes the resulting HTML to the UI. The page component renders the HTML inside `MarkdownRenderer` without additional processing.
- `src/components/markdown/markdown-renderer.tsx:1-13` wraps the HTML in a `div` and uses `dangerouslySetInnerHTML`, meaning whatever path the Markdown supplied becomes the final `<img src>` attribute.

### Static asset location

- `public/redux_devtools_screenshot.png` is the actual screenshot file checked into the repository. Nothing under `public/public/` exists, so a request for `/public/redux_devtools_screenshot.png` cannot be satisfied by the filesystem-backed static asset handler.

## Code References

- `src/page-content/redx-devtools.md:1-97` – Markdown article with the `/public/...` image reference.
- `src/lib/content/markdown.ts:34-90` – Remark/Rehype pipeline that converts Markdown to sanitized HTML without altering `img` sources.
- `src/pages/[slug].tsx:25-88` – Static page entry that loads Markdown HTML and renders it on the route.
- `src/components/markdown/markdown-renderer.tsx:1-13` – Component that injects the pre-rendered HTML directly into the DOM.
- `public/redux_devtools_screenshot.png` – The screenshot asset stored at the project root-level `public/` directory.

## Architecture Documentation

Markdown files in `src/page-content` are compiled at build time through `loadMarkdown`, which outputs sanitized HTML while preserving inline resource URLs. Pages generated by `[slug].tsx` stream that HTML to the client unchanged. Static files sit under the repository's `public/` directory and are exposed at the site root; any Markdown reference that prepends `/public/` will therefore point to a non-existent nested directory when served.

## Historical Context (from thoughts/)

- `thoughts/shared/plans/2025-10-02-markdown-page-routing.md:46-137` outlined the original plan for the Markdown loading and rendering stack, including the decision to rely on remark/rehype to emit HTML that pages render verbatim.

## Related Research

None recorded.

## Open Questions

None identified during this investigation.
